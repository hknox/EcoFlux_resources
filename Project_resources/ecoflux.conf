<VirtualHost *:80>
        ServerName grandwazoo.ddns.net
        RewriteEngine On
        RewriteRule ^/?(.*) https://%{SERVER_NAME}/$1 [R=301,L]
</VirtualHost>

<VirtualHost *:443>
        ServerAdmin hank.knox@mcgill.ca
        ServerName grandwazoo.ddns.net
        DocumentRoot /srv/ecoflux

        # WSGI configuration
        WSGIDaemonProcess ecoflux python-home=/srv/ecoflux/.venv python-path=/srv/ecoflux
        WSGIProcessGroup ecoflux
        WSGIScriptAlias /ecoflux /srv/ecoflux/EcoFlux/wsgi-production.py process-group=ecoflux application-group=%{GLOBAL}
       #WSGIScriptAlias /ecoflux/ /srv/ecoflux/EcoFlux/wsgi.py

       <Directory /srv/ecoflux/EcoFlux>
          <Files wsgi.py>
             Require all granted
          </Files>
       </Directory>
       <Directory /srv/ecoflux/EcoFlux>
          Require all granted
       </Directory>
       <Directory /srv/ecoflux>
          Require all granted
       </Directory>

       Alias /ecoflux/static/ /srv/ecoflux/staticfiles/
       <Directory /srv/ecoflux/staticfiles/>
          Require all granted
       </Directory>

       ErrorLog ${APACHE_LOG_DIR}/ecoflux_error.log
       CustomLog ${APACHE_LOG_DIR}/ecoflux_access.log combined

       SSLEngine on
       SSLCertificateFile /etc/ssl/nextcloud/grandwazoo_ddns_net.crt
       SSLCertificateKeyFile /etc/ssl/nextcloud/grandwazoo.ddns.net.key
       SSLCertificateChainFile /etc/ssl/nextcloud/DigiCertCA.crt
</VirtualHost>
