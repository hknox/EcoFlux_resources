<!-- EcoFlux/templates/location_detail_form.html -->
{% extends "inventory/site_base.html" %}
{% load django_bootstrap5 %}


{% block title %}EcoFlux Site - Location{% endblock %}

{% block content %}
  <h1>Location Details</h1>

  <!-- Location Update Form -->
  <form method="post" enctype="multipart/form-data" class="d-inline track-unsaved">
    {% csrf_token %}
    {% bootstrap_form form %}

    <!-- Button group wrapper -->
    <div class="d-flex gap-2 mt-3 align-items-start flex-wrap">
      <!-- Save button  -->
      <button type="submit" class="btn btn-success">
        <i class="bi bi-check-circle"></i> Save
      </button>

      <!-- Cancel -->
      <a href="{% url 'view_locations' %}"
         class="btn btn-secondary"
         onclick="return confirmCancel(event);"
         data-skip-unsaved-check>
        <i class="bi bi-x-circle"></i> Cancel
      </a>
  </form>  {# <-- CLOSES update form properly before starting the next #}
  {% if location.id %}
    <!-- Separate Delete form, styled inline -->
    <form method="post"
          action="{% url 'delete_location' location.id %}"
          onsubmit="return confirmDelete();"
          class="d-inline">
      {% csrf_token %}
      <button type="submit" class="btn btn-danger">
        <i class="bi bi-trash"></i> Delete
      </button>
    </form>
  {% endif %}
  </div>

  {% if items %}
    <h4 class="mt-4">Inventory items at this location:</h4>
    <ul class="list-group">
      {% for item in items %}
        <li class="list-group-item d-flex justify-content-between align-items-center">
          {{ item.description }}
          <span class="badge bg-secondary">{{ item.status }}</span>
        </li>
      {% endfor %}
    </ul>
  {% endif %}

{% endblock content %}
